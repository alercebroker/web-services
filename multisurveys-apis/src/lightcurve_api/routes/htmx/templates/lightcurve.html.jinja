<div id="chart" style="width: 100%;height:100%;"></div>
<script type="module">
// Initialize the echarts instance and use the current system theme
var mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
var theme = mediaQuery.matches ? 'dark' : 'light';
var chartDom = document.getElementById('chart')
var myChart = echarts.init(chartDom, theme);
var options = {{ options | tojson }};

// Make chart responsive
var plotGrid = document.getElementById('plot-grid');
var resizeObserver = new ResizeObserver(_ => {
  myChart.resize();
});
resizeObserver.observe(plotGrid);

// Dynamic theme switching. This detects system theme changes and updates the chart accordingly.
mediaQuery.addListener((e) => {
    const theme = e.matches ? 'dark' : 'light';
    myChart.clear()
    myChart.dispose();
    myChart = echarts.init(document.getElementById('chart'), theme);
    myChart.setOption(options);
});

// Display the chart using the configuration items and data just specified.
myChart.setOption(options);
</script>
