<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <!-- Include the ECharts file you just downloaded -->
    <script src="{{API_URL}}/static/echarts.min.js"></script>
    <script src="{{API_URL}}/static/htmx.min.js"></script>
    <meta name="htmx-config" content='{"selfRequestsOnly": false}'>
    <link rel="stylesheet" href="{{ API_URL }}/static/main.css">
  </head>
  <body>
    <!-- Prepare a DOM with a defined width and height for ECharts -->
    <div id="lightcurve-multisurvey" style="width: 100%;height:100%;min-height:400px;"></div>
    <script type="text/javascript">
      // Initialize the echarts instance based on the prepared dom
      var chartDom = document.getElementById('lightcurve-multisurvey')
      var myChart = echarts.init(chartDom);
      const options = {{ options | tojson }};

      // Make chart responsive
      window.addEventListener('resize', function() {
        const threshold = 1100;
        const containerWidth = chartDom.offsetWidth;
        const newOption = {
          legend: {orient: 'horizontal', bottom: 0},
          grid: {bottom: "30%"}
        };
        const oldOption = {
          legend: options.legend,
          grid: options.grid
        }
        if (containerWidth < threshold) {
          myChart.setOption(newOption);
        } else {
          myChart.setOption(oldOption);
        }

        myChart.resize();
      });

      // Display the chart using the configuration items and data just specified.
      myChart.setOption(options);
    </script>

  </body>
</html>
