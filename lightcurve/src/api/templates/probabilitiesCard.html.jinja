<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Probabilities</title>
    <link rel="stylesheet" href="{{API_URL}}/static/main.css">

</head>

<body class="tw-preflight dark:tw-bg-black tw-dark tw-flex tw-justify-center tw-h-[100vh]">

    <div
        class="tw-bg-white tw-shadow-2xl dark:tw-bg-[#1e1e1e] tw-w-[750px] tw-rounded-[6px] tw-box-content tw-p-[10px] tw-relative tw-mt-3 tw-ml-3">

        <div class="display-menu">

        </div>
        <div class="tw-relative tw-w-[50%] tw-h-[50%]">
            <canvas id="myChart"></canvas>
        </div>


    </div>




    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>

        let db = [{ "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "SNIa", "probability": 0.066, "ranking": 4 }, { "classifier_name": "lc_classifier_periodic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "LPV", "probability": 0.308, "ranking": 1 }, { "classifier_name": "lc_classifier_stochastic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "QSO", "probability": 0.028, "ranking": 4 }, { "classifier_name": "lc_classifier_top", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "Transient", "probability": 1.0, "ranking": 1 }, { "classifier_name": "lc_classifier_transient", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "SNIa", "probability": 0.066, "ranking": 4 }, { "classifier_name": "stamp_classifier", "classifier_version": "stamp_classifier_1.0.0", "class_name": "SN", "probability": 0.79377556, "ranking": 1 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "SNIbc", "probability": 0.12, "ranking": 3 }, { "classifier_name": "lc_classifier_periodic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "E", "probability": 0.068, "ranking": 6 }, { "classifier_name": "lc_classifier_stochastic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "AGN", "probability": 0.076, "ranking": 3 }, { "classifier_name": "lc_classifier_top", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "Stochastic", "probability": 0.0, "ranking": 2 }, { "classifier_name": "lc_classifier_transient", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "SNIbc", "probability": 0.12, "ranking": 3 }, { "classifier_name": "stamp_classifier", "classifier_version": "stamp_classifier_1.0.0", "class_name": "AGN", "probability": 0.054537576, "ranking": 3 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "SNII", "probability": 0.666, "ranking": 1 }, { "classifier_name": "lc_classifier_periodic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "DSCT", "probability": 0.072, "ranking": 5 }, { "classifier_name": "lc_classifier_stochastic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "Blazar", "probability": 0.132, "ranking": 2 }, { "classifier_name": "lc_classifier_top", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "Periodic", "probability": 0.0, "ranking": 2 }, { "classifier_name": "lc_classifier_transient", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "SNII", "probability": 0.666, "ranking": 1 }, { "classifier_name": "stamp_classifier", "classifier_version": "stamp_classifier_1.0.0", "class_name": "VS", "probability": 0.06481175, "ranking": 2 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "SLSN", "probability": 0.148, "ranking": 2 }, { "classifier_name": "lc_classifier_periodic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "RRL", "probability": 0.252, "ranking": 2 }, { "classifier_name": "lc_classifier_stochastic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "CV/Nova", "probability": 0.74, "ranking": 1 }, { "classifier_name": "lc_classifier_transient", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "SLSN", "probability": 0.148, "ranking": 2 }, { "classifier_name": "stamp_classifier", "classifier_version": "stamp_classifier_1.0.0", "class_name": "asteroid", "probability": 0.0374948, "ranking": 5 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "QSO", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier_periodic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "CEP", "probability": 0.164, "ranking": 3 }, { "classifier_name": "lc_classifier_stochastic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "YSO", "probability": 0.024, "ranking": 5 }, { "classifier_name": "stamp_classifier", "classifier_version": "stamp_classifier_1.0.0", "class_name": "bogus", "probability": 0.049380366, "ranking": 4 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "AGN", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier_periodic", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "Periodic-Other", "probability": 0.136, "ranking": 4 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "Blazar", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "CV/Nova", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "YSO", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "LPV", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "E", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "DSCT", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "RRL", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "CEP", "probability": 0.0, "ranking": 5 }, { "classifier_name": "lc_classifier", "classifier_version": "hierarchical_rf_1.1.0", "class_name": "Periodic-Other", "probability": 0.0, "ranking": 5 }]
        
        function uniqueValues(db) {
            
            const classKeys = [];

            for (let i = 0; i < db.length; i++){
                if (!(classKeys.includes(db[i].classifier_name))){
                    classKeys.push(db[i].classifier_name);
                }        
            }
            return classKeys;
        }

        function generateDictionaries() {

            const uniqueKeys = uniqueValues(db);
            const result = {};

            for (let i = 0; i < uniqueKeys.length; i++) {
                result[uniqueKeys[i]] = {};
            }

            return [result,uniqueKeys];
        }

        function getData(db){

            const [principalDict,uniqueKeys] = generateDictionaries();

            for (let i = 0; i < db.length; i++){
                principalDict[db[i].classifier_name][db[i].class_name] = db[i].probability;
            }

            return [principalDict,uniqueKeys]
        }
        
        const [principalDict,uniqueKeys] = getData(db);

        function selector(n){
            return principalDict[uniqueKeys[n]];
        }

        let currentDict = selector(0);

        const ctx = document.getElementById('myChart').getContext('2d');

        

        const data = {
            labels: Object.keys(currentDict),
            datasets: [{
                label: 'Probabilities',
                data: Object.values(currentDict),
                fill: true,
                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                borderColor: 'rgb(255, 99, 132)',
                pointBackgroundColor: 'rgb(255, 99, 132)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgb(255, 99, 132)',
            }]
        };

        const config = {
            type: 'radar',
            data: data,
            options: {

                elements: {
                    line: {
                        borderWidth: 1,
                    },
                },
                scales: {
                    r: {
                        ticks: {
                            display: false,
                            maxTicksLimit: 5,

                        },
                        grid: {
                            color: 'white'
                        },
                        angleLines: {
                            color: 'white'
                        },
                    },

                },
                plugins: {
                    legend: {
                        display: false
                    }
                },
            }
        };

        const myChart = new Chart(ctx, config);



    </script>
</body>

</html>