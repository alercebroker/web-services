name: Build Staging

on:
  push:
    branches:
      - main

jobs:
  update_versions:
    uses: ./.github/workflows/update-versions.yaml
    with:
      build-type: staging

  lightcurve:
    uses: ./.github/workflows/build.yaml
    needs: update_versions
    with:
      build-type: staging
      service-name: lightcurve
      base-folder: lightcurve
      build-context: .

  astroobject:
    uses: ./.github/workflows/build.yaml
    needs: update_versions
    with:
      build-type: staging
      service-name: astroobject
      base-folder: astroobject
      build-context: astroobject
